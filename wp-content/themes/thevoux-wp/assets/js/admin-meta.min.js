jQuery(document).ready(function(d){d(".thb-register:not(.disabled)").on("click",function(e){var a=d(this),t=d("#thb_product_key").val(),o=d("#thb_purchase_code").val(),i=a.hasClass("thb_purchase_code"),n=i?a.data("verify-by-purchase"):a.data("verify"),s={domain:a.data("domain")};return i?s.purchase_code=o:s.product_key=t,d.ajax({method:"GET",url:n,data:s,beforeSend:function(){a.addClass("disabled")},error:function(e){if(a.removeClass("disabled"),e.responseText){var t=d.parseJSON(e.responseText);t.error_message&&d("#thb_error_messages").html("<p>"+t.error_message+"</p>")}},success:function(e){e.product_key&&(t=e.product_key),d.ajax(ajaxurl,{method:"POST",data:{action:"thb_update_options",key:t,expired:0,security:a.data("security")},success:function(){location.reload()}})}}),!1}),d(".thb-delete-key").on("click",function(e){var t=d(this);return d.ajax(ajaxurl,{method:"POST",data:{action:"thb_update_options",key:"",expired:0,security:t.data("security")},success:function(){location.reload()}}),!1});var o={popup:d("#thb-adm-popup"),close:d(".thb-popup-close"),btn:d(".import-opts-btn")};o.close.on("click",function(){d(this).closest(o.popup).removeClass("opvis")}),d(document).on("keyup",function(e){27===e.keyCode&&o.popup.hasClass("opvis")&&o.close.trigger("click")}),d(".thb-check-line [type=checkbox]").on("change",function(){var e=d(this);e.toggleClass("thb-checked"),"ty-contents"===e.attr("id")&&(e.hasClass("child-opened")?e.removeClass("child-opened").parent().next().removeClass("done"):e.addClass("child-opened").parent().next().addClass("done"))}),o.btn.on("click",function(){var e=d(this),t=e.data("demo");o.popup.find(".button").data("selected",t),o.popup.find("figure img").attr("src",e.closest(".theme").find("img").attr("src")),o.popup.find("[type=checkbox]"),o.popup.addClass("opvis")});var i=new FormData;"undefined"!=typeof ocdi&&(i.append("action","ocdi_import_demo_data"),i.append("security",ocdi.ajax_nonce)),o.popup.find("form").on("submit",function(e){e.preventDefault();var t=d(this),a=t.find(".button").data("selected");o.popup.find("form").addClass("thb-loading"),t.closest(".thb-popup-box").find(".thb-import-loading").addClass("opvis"),t.children("[type=submit]").addClass("disabled").attr("disabled","disabled").unbind("click"),i.append("selected",a),i.append("thb_import_options",t.serialize()),function a(o){d.ajax({method:"POST",url:ocdi.ajax_url,data:o,contentType:!1,processData:!1}).done(function(e){if(void 0!==e.status&&"newAJAX"===e.status)a(o);else if(void 0!==e.status&&"afterAllImportAJAX"===e.status){var t=new FormData;t.append("action","ocdi_after_import_data"),t.append("security",ocdi.ajax_nonce),a(t)}else location.reload()})}(i)}),ThbImage={uploader:function(e,t,a){var o=wp.media({title:ThbImageWidget.frame_title,multiple:!1,library:{type:"image"},button:{text:ThbImageWidget.button_title}});return o.on("close",function(){var e=o.state().get("selection").toJSON();d("#"+t).val(e[0].url),d("#"+a).val(e[0].alt)}),o.open(),!1}};var e=function(e){var a=e.find(".thb-image-holder"),o=e.find(".thb-upload-image"),i=e.find(".thb-remove-image"),n=e.find(".thb-image-id");0<n.val().length?(o.hide(),i.show()):(o.show(),i.hide()),o.on("click",function(e){e.preventDefault(),function(t){var a=wp.media({title:"Select an image",multiple:!1,library:{type:"image"},button:{text:"Add Image"}});a.on("select",function(){var e=a.state().get("selection").first().toJSON();t(e)}),a.open()}(function(e){var t="";t=void 0!==e.sizes.thumbnail?e.sizes.thumbnail:e.sizes.full,a.html('<img src="'+t.url+'" width="'+t.width+'" height="'+t.height+'" />'),n.val(e.id),o.hide(),i.show()})}),i.on("click",function(e){e.preventDefault(),confirm("Are you sure?")&&(a.empty(),n.val(""),o.show(),i.hide())})};d(".thb-upload-image-field").each(function(){e(d(this))})});